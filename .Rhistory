hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>',xvardos,'</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>',xvardos,'</b>'))) %>%
hc_xAxis(labels = list(style = list(color = "black")),
tickColor = "black")
dat <- data_to_boxplot(df,
attack,
type1,
name = "height in meters",
add_outliers = FALSE,
color = "black")
hcd = highchart() %>%
hc_xAxis(type = "category" ) %>%
hc_add_series_list(dat) %>%
hc_add_series(
data = df,
type = "scatter",
marker = list(radius = 2.5), alpha = 0.9,
hcaes(x = type1, y = attack, group = type1)
) %>%
hc_plotOptions(boxplot = list(
fillColor = '#F0F0E0',
lineWidth = 2,
medianColor = '#0C5DA5',
medianWidth = 3,
stemColor = '#A63400',
stemDashStyle = 'dot',
stemWidth = 1,
whiskerColor = '#3D9200',
whiskerLength = '20%',
whiskerWidth = 3,
color = 'black'
)) %>%
hc_legend (enabled = FALSE) %>%
hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>',xvardos,'</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>',xvardos,'</b>'))) %>%
hc_xAxis(labels = list(style = list(color = "black")),
tickColor = "black")
dat <- data_to_boxplot(df,
attack,
type1,
name = "height in meters",
add_outliers = FALSE,
color = "black")
hcd = highchart() %>%
hc_xAxis(type = "category" ) %>%
hc_add_series_list(dat) %>%
hc_add_series(
data = df,
type = "scatter",
marker = list(radius = 2.5), alpha = 0.9,
hcaes(x = type1, y = attack, group = type1)
) %>%
hc_plotOptions(boxplot = list(
fillColor = '#F0F0E0',
lineWidth = 2,
medianColor = '#0C5DA5',
medianWidth = 3,
stemColor = '#A63400',
stemDashStyle = 'dot',
stemWidth = 1,
whiskerColor = '#3D9200',
whiskerLength = '20%',
whiskerWidth = 3,
color = 'black'
)) %>%
hc_legend (enabled = FALSE) %>%
hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>',attack,'</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>',xvardos,'</b>'))) %>%
hc_xAxis(labels = list(style = list(color = "black")),
tickColor = "black")
dat <- data_to_boxplot(df,
attack,
type1,
name = "height in meters",
add_outliers = FALSE,
color = "black")
hcd = highchart() %>%
hc_xAxis(type = "category" ) %>%
hc_add_series_list(dat) %>%
hc_add_series(
data = df,
type = "scatter",
marker = list(radius = 2.5), alpha = 0.9,
hcaes(x = type1, y = attack, group = type1)
) %>%
hc_plotOptions(boxplot = list(
fillColor = '#F0F0E0',
lineWidth = 2,
medianColor = '#0C5DA5',
medianWidth = 3,
stemColor = '#A63400',
stemDashStyle = 'dot',
stemWidth = 1,
whiskerColor = '#3D9200',
whiskerLength = '20%',
whiskerWidth = 3,
color = 'black'
)) %>%
hc_legend (enabled = FALSE) %>%
hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>','attack','</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>',xvardos,'</b>'))) %>%
hc_xAxis(labels = list(style = list(color = "black")),
tickColor = "black")
dat <- data_to_boxplot(df,
attack,
type1,
name = "height in meters",
add_outliers = FALSE,
color = "black")
hcd = highchart() %>%
hc_xAxis(type = "category" ) %>%
hc_add_series_list(dat) %>%
hc_add_series(
data = df,
type = "scatter",
marker = list(radius = 2.5), alpha = 0.9,
hcaes(x = type1, y = attack, group = type1)
) %>%
hc_plotOptions(boxplot = list(
fillColor = '#F0F0E0',
lineWidth = 2,
medianColor = '#0C5DA5',
medianWidth = 3,
stemColor = '#A63400',
stemDashStyle = 'dot',
stemWidth = 1,
whiskerColor = '#3D9200',
whiskerLength = '20%',
whiskerWidth = 3,
color = 'black'
)) %>%
hc_legend (enabled = FALSE) %>%
hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>','attack','</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>','attack,'</b>'))) %>%
dat <- data_to_boxplot(df,
attack,
type1,
name = "height in meters",
add_outliers = FALSE,
color = "black")
hcd = highchart() %>%
hc_xAxis(type = "category" ) %>%
hc_add_series_list(dat) %>%
hc_add_series(
data = df,
type = "scatter",
marker = list(radius = 2.5), alpha = 0.9,
hcaes(x = type1, y = attack, group = type1)
) %>%
hc_plotOptions(boxplot = list(
fillColor = '#F0F0E0',
lineWidth = 2,
medianColor = '#0C5DA5',
medianWidth = 3,
stemColor = '#A63400',
stemDashStyle = 'dot',
stemWidth = 1,
whiskerColor = '#3D9200',
whiskerLength = '20%',
whiskerWidth = 3,
color = 'black'
)) %>%
hc_legend (enabled = FALSE) %>%
hc_title(text = 'Box Plot Pokemon',
style = list(fontSize = '20px', fontWeight = 'bold')) %>%
hc_subtitle(text = paste0('<b>','attack','</b>'),
style = list(fontSize = '16px', color = "black")) %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_yAxis(labels = list(style = list(color = "black")),
tickColor = "black",
title = list(text = paste0('<b>','attack','</b>'))) %>%
hc_xAxis(labels = list(style = list(color = "black")),
tickColor = "black")
hcd
library(flexdashboard)
library(highcharter)
library(viridis)
library(ggplot2)
library(tidyverse)
library(shiny)
library(dplyr)
library(RColorBrewer)
library(readxl)
library(Rtsne)
library(gapminder)
library(NbClust)
library(cluster)
library(fpc)
library(dendextend)
library(rgl)
df = read.csv('pokemon.csv')
txt = read_excel('values.xlsx', col_names =  T)
dfgroup = df %>% group_by(type1, type2) %>% count()
df_tsne = df[,c('sp_attack','sp_defense','hp','speed','attack','defense','type1','name', 'is_legendary', 'pokedex_number')]
PCA <- princomp(df_tsne[,c('sp_attack','sp_defense','hp','speed','attack','defense')],cor=T)
PCA
PCA$loadings
Loadings <- as.data.frame(PCA$loadings[,1:2])
View(Loadings)
View(df_tsne)
PCA$loadings
PCA
View(PCA)
a =PCA$loadings
a
PCA$sdev
PCA$scores
V = PCA$scores
View(V)
scores = PCA$scores
df_scores = as.data.frame(scores)
View(df_scores)
df_tsne$X = df_scores$Comp.1
df_tsne$Y = df_scores$Comp.2
img_input = paste0("<img src ='", colnames(txt) , "shiny/{point.pokedex_number}.png' width='100' height='120'> <ul><li><b>Pokemon: {point.name}</li></b> <li><b>Hp: {point.hp} </b></li> <li><b>Attack: {point.attack} </b></li><li><b>Defense: {point.defense} </b></li><li><b>Speed: {point.speed} </b></li><li><b>Legendary: {point.is_legendary} </b></li><li><b>Pokedex: {point.pokedex_number} </b></li></ul> ")
hc <-   df_tsne %>%
hchart("scatter", hcaes(x = df_tsne$X,
y = df_tsne$Y,
name = name,
group = is_legendary),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
#hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon RTSNE Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
set.seed(15)
df_tsne = df[,c('sp_attack','sp_defense','hp','speed','attack','defense','type1','name', 'is_legendary', 'pokedex_number')]
tsne = Rtsne(df_tsne[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
perplexity = 30,
eta = 1000,
max_iter = 5000,
check_duplicates = FALSE)
Y = as.data.frame(tsne$Y)
df_tsne$X = Y$V1
df_tsne$Y = Y$V2
img_input = paste0("<img src ='", colnames(txt) , "shiny/{point.pokedex_number}.png' width='100' height='120'> <ul><li><b>Pokemon: {point.name}</li></b> <li><b>Hp: {point.hp} </b></li> <li><b>Attack: {point.attack} </b></li><li><b>Defense: {point.defense} </b></li><li><b>Speed: {point.speed} </b></li><li><b>Legendary: {point.is_legendary} </b></li><li><b>Pokedex: {point.pokedex_number} </b></li></ul> ")
hc <-   df_tsne %>%
hchart("scatter", hcaes(x = df_tsne$X,
y = df_tsne$Y,
name = name,
group = is_legendary),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
#hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon RTSNE Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
set.seed(15)
df_model = df[,c('sp_attack','sp_defense','hp','speed','attack','defense','type1','name', 'is_legendary', 'pokedex_number')]
tsne = Rtsne(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
perplexity = 30,
eta = 1000,
max_iter = 5000,
check_duplicates = FALSE)
Y = as.data.frame(tsne$Y)
df_model$X = Y$V1
df_model$Y = Y$V2
img_input = paste0("<img src ='", colnames(txt) , "shiny/{point.pokedex_number}.png' width='100' height='120'> <ul><li><b>Pokemon: {point.name}</li></b> <li><b>Hp: {point.hp} </b></li> <li><b>Attack: {point.attack} </b></li><li><b>Defense: {point.defense} </b></li><li><b>Speed: {point.speed} </b></li><li><b>Legendary: {point.is_legendary} </b></li><li><b>Pokedex: {point.pokedex_number} </b></li></ul> ")
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X,
y = df_model$Y,
name = name,
group = is_legendary),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
#hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon RTSNE Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
PCA <- princomp(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],cor = T)
df_scores = as.data.frame(PCA$scores)
df_model$X_pca = df_scores$Comp.1
df_model$Y_pca = df_scores$Comp.2
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X_pca,
y = df_model$Y_pca,
name = name,
group = is_legendary),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon PCA Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
PCA <- princomp(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
cor = T,
scale=TRUE)
df_scores = as.data.frame(PCA$scores)
df_model$X_pca = df_scores$Comp.1
df_model$Y_pca = df_scores$Comp.2
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X_pca,
y = df_model$Y_pca,
name = name,
group = is_legendary),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon PCA Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
PCA <- princomp(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
cor = T,
scale=TRUE)
df_scores = as.data.frame(PCA$scores)
df_model$X_pca = df_scores$Comp.1
df_model$Y_pca = df_scores$Comp.2
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X_pca,
y = df_model$Y_pca,
name = name,
group = type1),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon PCA Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
PCA <- princomp(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
cor = T,
scale=TRUE)
df_scores = as.data.frame(PCA$scores)
df_model$X_pca = df_scores$Comp.1
df_model$Y_pca = df_scores$Comp.2
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X_pca,
y = df_model$Y_pca,
name = name,
group = type1),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon PCA Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
hc
PCA <- princomp(df_model[,c('sp_attack','sp_defense','hp','speed','attack','defense')],
cor = T)
df_scores = as.data.frame(PCA$scores)
df_model$X_pca = df_scores$Comp.1
df_model$Y_pca = df_scores$Comp.2
hc <-   df_model %>%
hchart("scatter", hcaes(x = df_model$X_pca,
y = df_model$Y_pca,
name = name,
group = type),
maxSize = "5%",
regression = FALSE,
regressionSettings = list(
type = "polynomial",
color = 'steelblue',
dashStyle = "ShortDash",
order = 1,
lineWidth = 5,
name = "%eq | r2: %r",
hideInLegend = TRUE)) %>%
hc_tooltip(pointFormat = img_input,
useHTML = T) %>%
hc_colors(c('#43c7d9', '#9c38c7')) %>%
hc_add_theme(hc_theme_google()) %>%
hc_add_dependency("plugins/highcharts-regression.js") %>%
hc_credits(enabled = TRUE, text = "Fuente: Kaggle",align = "right",verticalAlign = "bottom",
style = list(color = "black", fontSize = '15px'),
href = "https://www.kaggle.com/datasets/rounakbanik/pokemon") %>%
hc_title(text = paste0('Pokemon PCA Model - Legendary'),
style = list(fontSize = '20px', fontWeight = 'bold'))
